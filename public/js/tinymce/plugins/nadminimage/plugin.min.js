/**
 * editor_plugin_src.js
 *
 * Copyright 2012, 
 * Released under LGPL License.
 *
 * Author: Berkutov Y.V.
 */

(function() {
	// Load plugin specific language pack
	//tinymce.PluginManager.requireLangPack('picasa_image');

  tinymce.create("tinymce.plugins.nadminimage", {
    init : function(ed, url) {

      ed.addCommand("mceNewImage", function() {
        ed.windowManager.open({
          file : url + "/dialog.htm",
          width : $(window).width() * 0.8, 
          height : $(window).height() * 0.8, 
          inline : 1,
          resizable : "no",
          title:"挑選或上傳圖片"
        }, {
          plugin_url : url, // Plugin absolute URL
          some_custom_arg : "custom arg", // Custom argument
          scrollbars : "yes"
        });
      });

// Register PicasaImage button
      ed.addButton("nadminimage", {
        title : "上傳圖片",
        cmd : "mceNewImage",
//image : url + '/img/picasa_image.gif',
        text: "上傳圖片",
        stateSelector: "img"
      });

// Add a node change handler, selects the button in the UI when a image is selected
//ed.onNodeChange.add(function(ed, cm, n) {
//	cm.setActive('picasa_image', n.nodeName == 'IMG');
//});
    },

    createControl : function(n, cm) {
      return null;
    },

    getInfo : function() {
      return {
        longname : "Image plugin",
        author : "TonyQ",
        authorurl : "",
        infourl : "",
        version : "1.0"
      };
    }
  });

// Register plugin
  tinymce.PluginManager.add("nadminimage", tinymce.plugins.nadminimage);
})();